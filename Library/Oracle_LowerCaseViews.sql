-- Replace "CDM_VIEW" with the correct schema
create or replace view "CDM_VIEW"."adt_occurrence" as select "ADT_DATE" as "adt_date", "ADT_DATETIME" as "adt_datetime", "ADT_OCCURRENCE_ID" as "adt_occurrence_id", "ADT_TYPE_CONCEPT_ID" as "adt_type_concept_id", "ADT_TYPE_SOURCE_VALUE" as "adt_type_source_value", "CARE_SITE_ID" as "care_site_id", "NEXT_ADT_OCCURRENCE_ID" as "next_adt_occurrence_id", "PERSON_ID" as "person_id", "PRIOR_ADT_OCCURRENCE_ID" as "prior_adt_occurrence_id", "SERVICE_CONCEPT_ID" as "service_concept_id", "SERVICE_SOURCE_VALUE" as "service_source_value", "VISIT_OCCURRENCE_ID" as "visit_occurrence_id" from "DCC_PEDSNET"."ADT_OCCURRENCE";
create or replace view "CDM_VIEW"."care_site" as select "CARE_SITE_ID" as "care_site_id", "CARE_SITE_NAME" as "care_site_name", "CARE_SITE_SOURCE_VALUE" as "care_site_source_value", "LOCATION_ID" as "location_id", "PLACE_OF_SERVICE_CONCEPT_ID" as "place_of_service_concept_id", "PLACE_OF_SERVICE_SOURCE_VALUE" as "place_of_service_source_value", "SPECIALTY_CONCEPT_ID" as "specialty_concept_id", "SPECIALTY_SOURCE_VALUE" as "specialty_source_value" from "DCC_PEDSNET"."CARE_SITE";
create or replace view "CDM_VIEW"."condition_era" as select "CONDITION_CONCEPT_ID" as "condition_concept_id", "CONDITION_ERA_END_DATE" as "condition_era_end_date", "CONDITION_ERA_ID" as "condition_era_id", "CONDITION_ERA_START_DATE" as "condition_era_start_date", "CONDITION_OCCURRENCE_COUNT" as "condition_occurrence_count", "PERSON_ID" as "person_id" from "DCC_PEDSNET"."CONDITION_ERA";
create or replace view "CDM_VIEW"."condition_occurrence" as select "CONDITION_CONCEPT_ID" as "condition_concept_id", "CONDITION_END_DATE" as "condition_end_date", "CONDITION_END_DATETIME" as "condition_end_datetime", "CONDITION_OCCURRENCE_ID" as "condition_occurrence_id", "CONDITION_SOURCE_CONCEPT_ID" as "condition_source_concept_id", "CONDITION_SOURCE_VALUE" as "condition_source_value", "CONDITION_START_DATE" as "condition_start_date", "CONDITION_START_DATETIME" as "condition_start_datetime", "CONDITION_STATUS_CONCEPT_ID" as "condition_status_concept_id", "CONDITION_STATUS_SOURCE_VALUE" as "condition_status_source_value", "CONDITION_TYPE_CONCEPT_ID" as "condition_type_concept_id", "PERSON_ID" as "person_id", "POA_CONCEPT_ID" as "poa_concept_id", "PROVIDER_ID" as "provider_id", "STOP_REASON" as "stop_reason", "VISIT_OCCURRENCE_ID" as "visit_occurrence_id" from "DCC_PEDSNET"."CONDITION_OCCURRENCE";
create or replace view "CDM_VIEW"."death" as select "CAUSE_CONCEPT_ID" as "cause_concept_id", "CAUSE_SOURCE_CONCEPT_ID" as "cause_source_concept_id", "CAUSE_SOURCE_VALUE" as "cause_source_value", "DEATH_CAUSE_ID" as "death_cause_id", "DEATH_DATE" as "death_date", "DEATH_DATETIME" as "death_datetime", "DEATH_IMPUTE_CONCEPT_ID" as "death_impute_concept_id", "DEATH_TYPE_CONCEPT_ID" as "death_type_concept_id", "PERSON_ID" as "person_id" from "DCC_PEDSNET"."DEATH";
create or replace view "CDM_VIEW"."dose_era" as select "DOSE_ERA_END_DATE" as "dose_era_end_date", "DOSE_ERA_ID" as "dose_era_id", "DOSE_ERA_START_DATE" as "dose_era_start_date", "DOSE_VALUE" as "dose_value", "DRUG_CONCEPT_ID" as "drug_concept_id", "PERSON_ID" as "person_id", "UNIT_CONCEPT_ID" as "unit_concept_id" from "DCC_PEDSNET"."DOSE_ERA";
create or replace view "CDM_VIEW"."drug_era" as select "DRUG_CONCEPT_ID" as "drug_concept_id", "DRUG_ERA_END_DATE" as "drug_era_end_date", "DRUG_ERA_ID" as "drug_era_id", "DRUG_ERA_START_DATE" as "drug_era_start_date", "DRUG_EXPOSURE_COUNT" as "drug_exposure_count", "GAP_DAYS" as "gap_days", "PERSON_ID" as "person_id" from "DCC_PEDSNET"."DRUG_ERA";
create or replace view "CDM_VIEW"."drug_exposure" as select "DAYS_SUPPLY" as "days_supply", "DISPENSE_AS_WRITTEN_CONCEPT_ID" as "dispense_as_written_concept_id", "DOSE_UNIT_CONCEPT_ID" as "dose_unit_concept_id", "DOSE_UNIT_SOURCE_VALUE" as "dose_unit_source_value", "DRUG_CONCEPT_ID" as "drug_concept_id", "DRUG_EXPOSURE_END_DATE" as "drug_exposure_end_date", "DRUG_EXPOSURE_END_DATETIME" as "drug_exposure_end_datetime", "DRUG_EXPOSURE_ID" as "drug_exposure_id", "DRUG_EXPOSURE_ORDER_DATE" as "drug_exposure_order_date", "DRUG_EXPOSURE_ORDER_DATETIME" as "drug_exposure_order_datetime", "DRUG_EXPOSURE_START_DATE" as "drug_exposure_start_date", "DRUG_EXPOSURE_START_DATETIME" as "drug_exposure_start_datetime", "DRUG_SOURCE_CONCEPT_ID" as "drug_source_concept_id", "DRUG_SOURCE_VALUE" as "drug_source_value", "DRUG_TYPE_CONCEPT_ID" as "drug_type_concept_id", "EFF_DRUG_DOSE_SOURCE_VALUE" as "eff_drug_dose_source_value", "EFFECTIVE_DRUG_DOSE" as "effective_drug_dose", "FREQUENCY" as "frequency", "LOT_NUMBER" as "lot_number", "PERSON_ID" as "person_id", "PROVIDER_ID" as "provider_id", "QUANTITY" as "quantity", "REFILLS" as "refills", "ROUTE_CONCEPT_ID" as "route_concept_id", "ROUTE_SOURCE_VALUE" as "route_source_value", "SIG" as "sig", "STOP_REASON" as "stop_reason", "VISIT_OCCURRENCE_ID" as "visit_occurrence_id" from "DCC_PEDSNET"."DRUG_EXPOSURE";
create or replace view "CDM_VIEW"."drug_strength" as select "AMOUNT_UNIT_CONCEPT_ID" as "amount_unit_concept_id", "AMOUNT_VALUE" as "amount_value", "BOX_SIZE" as "box_size", "DENOMINATOR_UNIT_CONCEPT_ID" as "denominator_unit_concept_id", "DENOMINATOR_VALUE" as "denominator_value", "DRUG_CONCEPT_ID" as "drug_concept_id", "INGREDIENT_CONCEPT_ID" as "ingredient_concept_id", "INVALID_REASON" as "invalid_reason", "NUMERATOR_UNIT_CONCEPT_ID" as "numerator_unit_concept_id", "NUMERATOR_VALUE" as "numerator_value", "VALID_END_DATE" as "valid_end_date", "VALID_START_DATE" as "valid_start_date" from "DCC_PEDSNET"."DRUG_STRENGTH";
create or replace view "CDM_VIEW"."fact_relationship" as select "DOMAIN_CONCEPT_ID_1" as "domain_concept_id_1", "DOMAIN_CONCEPT_ID_2" as "domain_concept_id_2", "FACT_ID_1" as "fact_id_1", "FACT_ID_2" as "fact_id_2", "RELATIONSHIP_CONCEPT_ID" as "relationship_concept_id" from "DCC_PEDSNET"."FACT_RELATIONSHIP";
create or replace view "CDM_VIEW"."immunization" as select "IMM_DOSE_UNIT_CONCEPT_ID" as "imm_dose_unit_concept_id", "IMM_DOSE_UNIT_SOURCE_VALUE" as "imm_dose_unit_source_value", "IMM_ROUTE_CONCEPT_ID" as "imm_route_concept_id", "IMM_ROUTE_SOURCE_VALUE" as "imm_route_source_value", "IMMUNIZATION_CONCEPT_ID" as "immunization_concept_id", "IMMUNIZATION_DATE" as "immunization_date", "IMMUNIZATION_DATETIME" as "immunization_datetime", "IMMUNIZATION_DOSE" as "immunization_dose", "IMMUNIZATION_ID" as "immunization_id", "IMMUNIZATION_SOURCE_CONCEPT_ID" as "immunization_source_concept_id", "IMMUNIZATION_SOURCE_VALUE" as "immunization_source_value", "PERSON_ID" as "person_id", "PROCEDURE_OCCURRENCE_ID" as "procedure_occurrence_id", "PROVIDER_ID" as "provider_id", "VISIT_OCCURRENCE_ID" as "visit_occurrence_id" from "DCC_PEDSNET"."IMMUNIZATION";
create or replace view "CDM_VIEW"."location" as select "ADDRESS_1" as "address_1", "ADDRESS_2" as "address_2", "CITY" as "city", "COUNTY" as "county", "LOCATION_ID" as "location_id", "LOCATION_SOURCE_VALUE" as "location_source_value", "STATE" as "state", "ZIP" as "zip" from "DCC_PEDSNET"."LOCATION";
create or replace view "CDM_VIEW"."measurement" as select "MEASUREMENT_CONCEPT_ID" as "measurement_concept_id", "MEASUREMENT_DATE" as "measurement_date", "MEASUREMENT_DATETIME" as "measurement_datetime", "MEASUREMENT_ID" as "measurement_id", "MEASUREMENT_ORDER_DATE" as "measurement_order_date", "MEASUREMENT_ORDER_DATETIME" as "measurement_order_datetime", "MEASUREMENT_RESULT_DATE" as "measurement_result_date", "MEASUREMENT_RESULT_DATETIME" as "measurement_result_datetime", "MEASUREMENT_SOURCE_CONCEPT_ID" as "measurement_source_concept_id", "MEASUREMENT_SOURCE_VALUE" as "measurement_source_value", "MEASUREMENT_TYPE_CONCEPT_ID" as "measurement_type_concept_id", "OPERATOR_CONCEPT_ID" as "operator_concept_id", "PERSON_ID" as "person_id", "PRIORITY_CONCEPT_ID" as "priority_concept_id", "PRIORITY_SOURCE_VALUE" as "priority_source_value", "PROVIDER_ID" as "provider_id", "RANGE_HIGH" as "range_high", "RANGE_HIGH_OPERATOR_CONCEPT_ID" as "range_high_operator_concept_id", "RANGE_HIGH_SOURCE_VALUE" as "range_high_source_value", "RANGE_LOW" as "range_low", "RANGE_LOW_OPERATOR_CONCEPT_ID" as "range_low_operator_concept_id", "RANGE_LOW_SOURCE_VALUE" as "range_low_source_value", "SPECIMEN_CONCEPT_ID" as "specimen_concept_id", "SPECIMEN_SOURCE_VALUE" as "specimen_source_value", "UNIT_CONCEPT_ID" as "unit_concept_id", "UNIT_SOURCE_VALUE" as "unit_source_value", "VALUE_AS_CONCEPT_ID" as "value_as_concept_id", "VALUE_AS_NUMBER" as "value_as_number", "VALUE_SOURCE_VALUE" as "value_source_value", "VISIT_OCCURRENCE_ID" as "visit_occurrence_id" from "DCC_PEDSNET"."MEASUREMENT";
create or replace view "CDM_VIEW"."measurement_organism" as select "MEAS_ORGANISM_ID" as "meas_organism_id", "MEASUREMENT_ID" as "measurement_id", "ORGANISM_CONCEPT_ID" as "organism_concept_id", "ORGANISM_SOURCE_VALUE" as "organism_source_value", "PERSON_ID" as "person_id", "POSITIVITY_DATETIME" as "positivity_datetime", "VISIT_OCCURRENCE_ID" as "visit_occurrence_id" from "DCC_PEDSNET"."MEASUREMENT_ORGANISM";
create or replace view "CDM_VIEW"."observation" as select "OBSERVATION_CONCEPT_ID" as "observation_concept_id", "OBSERVATION_DATE" as "observation_date", "OBSERVATION_DATETIME" as "observation_datetime", "OBSERVATION_ID" as "observation_id", "OBSERVATION_SOURCE_CONCEPT_ID" as "observation_source_concept_id", "OBSERVATION_SOURCE_VALUE" as "observation_source_value", "OBSERVATION_TYPE_CONCEPT_ID" as "observation_type_concept_id", "PERSON_ID" as "person_id", "PROVIDER_ID" as "provider_id", "QUALIFIER_CONCEPT_ID" as "qualifier_concept_id", "QUALIFIER_SOURCE_VALUE" as "qualifier_source_value", "UNIT_CONCEPT_ID" as "unit_concept_id", "UNIT_SOURCE_VALUE" as "unit_source_value", "VALUE_AS_CONCEPT_ID" as "value_as_concept_id", "VALUE_AS_NUMBER" as "value_as_number", "VALUE_AS_STRING" as "value_as_string", "VISIT_OCCURRENCE_ID" as "visit_occurrence_id" from "DCC_PEDSNET"."OBSERVATION";
create or replace view "CDM_VIEW"."observation_period" as select "OBSERVATION_PERIOD_END_DATE" as "observation_period_end_date", "OBSERVATION_PERIOD_END_TIME" as "observation_period_end_time", "OBSERVATION_PERIOD_ID" as "observation_period_id", "OBSERVATION_PERIOD_START_DATE" as "observation_period_start_date", "OBSERVATION_PERIOD_START_TIME" as "observation_period_start_time", "PERIOD_TYPE_CONCEPT_ID" as "period_type_concept_id", "PERSON_ID" as "person_id" from "DCC_PEDSNET"."OBSERVATION_PERIOD";
create or replace view "CDM_VIEW"."person" as select "BIRTH_DATETIME" as "birth_datetime", "CARE_SITE_ID" as "care_site_id", "DAY_OF_BIRTH" as "day_of_birth", "ETHNICITY_CONCEPT_ID" as "ethnicity_concept_id", "ETHNICITY_SOURCE_CONCEPT_ID" as "ethnicity_source_concept_id", "ETHNICITY_SOURCE_VALUE" as "ethnicity_source_value", "GENDER_CONCEPT_ID" as "gender_concept_id", "GENDER_SOURCE_CONCEPT_ID" as "gender_source_concept_id", "GENDER_SOURCE_VALUE" as "gender_source_value", "LANGUAGE_CONCEPT_ID" as "language_concept_id", "LANGUAGE_SOURCE_CONCEPT_ID" as "language_source_concept_id", "LANGUAGE_SOURCE_VALUE" as "language_source_value", "LOCATION_ID" as "location_id", "MONTH_OF_BIRTH" as "month_of_birth", "PERSON_ID" as "person_id", "PERSON_SOURCE_VALUE" as "person_source_value", "PN_GESTATIONAL_AGE" as "pn_gestational_age", "PROVIDER_ID" as "provider_id", "RACE_CONCEPT_ID" as "race_concept_id", "RACE_SOURCE_CONCEPT_ID" as "race_source_concept_id", "RACE_SOURCE_VALUE" as "race_source_value", "YEAR_OF_BIRTH" as "year_of_birth" from "DCC_PEDSNET"."PERSON";
create or replace view "CDM_VIEW"."procedure_occurrence" as select "MODIFIER_CONCEPT_ID" as "modifier_concept_id", "MODIFIER_SOURCE_VALUE" as "modifier_source_value", "PERSON_ID" as "person_id", "PROCEDURE_CONCEPT_ID" as "procedure_concept_id", "PROCEDURE_DATE" as "procedure_date", "PROCEDURE_DATETIME" as "procedure_datetime", "PROCEDURE_OCCURRENCE_ID" as "procedure_occurrence_id", "PROCEDURE_SOURCE_CONCEPT_ID" as "procedure_source_concept_id", "PROCEDURE_SOURCE_VALUE" as "procedure_source_value", "PROCEDURE_TYPE_CONCEPT_ID" as "procedure_type_concept_id", "PROVIDER_ID" as "provider_id", "QUANTITY" as "quantity", "VISIT_OCCURRENCE_ID" as "visit_occurrence_id" from "DCC_PEDSNET"."PROCEDURE_OCCURRENCE";
create or replace view "CDM_VIEW"."provider" as select "CARE_SITE_ID" as "care_site_id", "DEA" as "dea", "GENDER_CONCEPT_ID" as "gender_concept_id", "GENDER_SOURCE_CONCEPT_ID" as "gender_source_concept_id", "GENDER_SOURCE_VALUE" as "gender_source_value", "NPI" as "npi", "PROVIDER_ID" as "provider_id", "PROVIDER_NAME" as "provider_name", "PROVIDER_SOURCE_VALUE" as "provider_source_value", "SPECIALTY_CONCEPT_ID" as "specialty_concept_id", "SPECIALTY_SOURCE_CONCEPT_ID" as "specialty_source_concept_id", "SPECIALTY_SOURCE_VALUE" as "specialty_source_value", "YEAR_OF_BIRTH" as "year_of_birth" from "DCC_PEDSNET"."PROVIDER";
create or replace view "CDM_VIEW"."relationship" as select "DEFINES_ANCESTRY" as "defines_ancestry", "IS_HIERARCHICAL" as "is_hierarchical", "RELATIONSHIP_CONCEPT_ID" as "relationship_concept_id", "RELATIONSHIP_ID" as "relationship_id", "RELATIONSHIP_NAME" as "relationship_name", "REVERSE_RELATIONSHIP_ID" as "reverse_relationship_id" from "DCC_PEDSNET"."RELATIONSHIP";
create or replace view "CDM_VIEW"."visit_occurrence" as select "ADMITTING_SOURCE_CONCEPT_ID" as "admitting_source_concept_id", "ADMITTING_SOURCE_VALUE" as "admitting_source_value", "CARE_SITE_ID" as "care_site_id", "DISCHARGE_TO_CONCEPT_ID" as "discharge_to_concept_id", "DISCHARGE_TO_SOURCE_VALUE" as "discharge_to_source_value", "PERSON_ID" as "person_id", "PRECEDING_VISIT_OCCURRENCE_ID" as "preceding_visit_occurrence_id", "PROVIDER_ID" as "provider_id", "VISIT_CONCEPT_ID" as "visit_concept_id", "VISIT_END_DATE" as "visit_end_date", "VISIT_END_DATETIME" as "visit_end_datetime", "VISIT_OCCURRENCE_ID" as "visit_occurrence_id", "VISIT_SOURCE_CONCEPT_ID" as "visit_source_concept_id", "VISIT_SOURCE_VALUE" as "visit_source_value", "VISIT_START_DATE" as "visit_start_date", "VISIT_START_DATETIME" as "visit_start_datetime", "VISIT_TYPE_CONCEPT_ID" as "visit_type_concept_id" from "DCC_PEDSNET"."VISIT_OCCURRENCE";
create or replace view "CDM_VIEW"."visit_payer" as select "PLAN_CLASS" as "plan_class", "PLAN_NAME" as "plan_name", "PLAN_TYPE" as "plan_type", "VISIT_OCCURRENCE_ID" as "visit_occurrence_id", "VISIT_PAYER_ID" as "visit_payer_id", "VISIT_PAYER_TYPE_CONCEPT_ID" as "visit_payer_type_concept_id" from "DCC_PEDSNET"."VISIT_PAYER";

grant select on "CDM_VIEW"."adt_occurrence" to "CDM_VIEW";
grant select on "CDM_VIEW"."care_site" to "CDM_VIEW";
grant select on "CDM_VIEW"."condition_era" to "CDM_VIEW";
grant select on "CDM_VIEW"."condition_occurrence" to "CDM_VIEW";
grant select on "CDM_VIEW"."death" to "CDM_VIEW";
grant select on "CDM_VIEW"."dose_era" to "CDM_VIEW";
grant select on "CDM_VIEW"."drug_era" to "CDM_VIEW";
grant select on "CDM_VIEW"."drug_exposure" to "CDM_VIEW";
grant select on "CDM_VIEW"."drug_strength" to "CDM_VIEW";
grant select on "CDM_VIEW"."fact_relationship" to "CDM_VIEW";
grant select on "CDM_VIEW"."immunization" to "CDM_VIEW";
grant select on "CDM_VIEW"."location" to "CDM_VIEW";
grant select on "CDM_VIEW"."measurement" to "CDM_VIEW";
grant select on "CDM_VIEW"."measurement_organism" to "CDM_VIEW";
grant select on "CDM_VIEW"."observation" to "CDM_VIEW";
grant select on "CDM_VIEW"."observation_period" to "CDM_VIEW";
grant select on "CDM_VIEW"."person" to "CDM_VIEW";
grant select on "CDM_VIEW"."procedure_occurrence" to "CDM_VIEW";
grant select on "CDM_VIEW"."provider" to "CDM_VIEW";
grant select on "CDM_VIEW"."relationship" to "CDM_VIEW";
grant select on "CDM_VIEW"."visit_occurrence" to "CDM_VIEW";
grant select on "CDM_VIEW"."visit_payer" to "CDM_VIEW";

-- Replace "DQA_VIEW" with the correct schema
create or replace view "DQA_VIEW"."drug_in_concept_id_map" as select "DRUG_CONCEPT_ID" as "drug_concept_id", "IN_CONCEPT_ID" as "in_concept_id", "IN_CONCEPT_NAME" as "in_concept_name" from "DQA_VIEW"."DRUG_IN_CONCEPT_ID_MAP";

grant select on "DQA_VIEW"."drug_in_concept_id_map" to DQA_VIEW;

create or replace view "VOCAB_VIEW"."concept" as select "CONCEPT_CLASS_ID" as "concept_class_id", "CONCEPT_CODE" as "concept_code", "CONCEPT_ID" as "concept_id", "CONCEPT_LEVEL" as "concept_level", "CONCEPT_NAME" as "concept_name", "DOMAIN_ID" as "domain_id", "INVALID_REASON" as "invalid_reason", "STANDARD_CONCEPT" as "standard_concept", "VALID_END_DATE" as "valid_end_date", "VALID_START_DATE" as "valid_start_date", "VOCABULARY_ID" as "vocabulary_id" from "DCC_PEDSNET"."CONCEPT";
create or replace view "VOCAB_VIEW"."concept_ancestor" as select "ANCESTOR_CONCEPT_ID" as "ancestor_concept_id", "DESCENDANT_CONCEPT_ID" as "descendant_concept_id", "MAX_LEVELS_OF_SEPARATION" as "max_levels_of_separation", "MIN_LEVELS_OF_SEPARATION" as "min_levels_of_separation" from "DCC_PEDSNET"."CONCEPT_ANCESTOR";
create or replace view "VOCAB_VIEW"."concept_relationship" as select "CONCEPT_ID_1" as "concept_id_1", "CONCEPT_ID_2" as "concept_id_2", "INVALID_REASON" as "invalid_reason", "RELATIONSHIP_ID" as "relationship_id", "VALID_END_DATE" as "valid_end_date", "VALID_START_DATE" as "valid_start_date" from "DCC_PEDSNET"."CONCEPT_RELATIONSHIP";
create or replace view "VOCAB_VIEW"."vocabulary" as select "VOCABULARY_CONCEPT_ID" as "vocabulary_concept_id", "VOCABULARY_ID" as "vocabulary_id", "VOCABULARY_NAME" as "vocabulary_name", "VOCABULARY_REFERENCE" as "vocabulary_reference", "VOCABULARY_VERSION" as "vocabulary_version" from "DCC_PEDSNET"."VOCABULARY";

grant select on "VOCAB_VIEW"."concept" to "CDM_VIEW";
grant select on "VOCAB_VIEW"."concept_ancestor" to "CDM_VIEW";
grant select on "VOCAB_VIEW"."concept_relationship" to "CDM_VIEW";
grant select on "VOCAB_VIEW"."vocabulary" to "CDM_VIEW";
